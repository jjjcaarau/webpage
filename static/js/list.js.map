{"version":3,"sources":["list.js"],"names":["fallbackCopyTextToClipboard","text","textArea","document","createElement","value","body","appendChild","focus","select","successful","msg","execCommand","console","log","err","error","removeChild","copyTextToClipboard","navigator","clipboard","writeText","catch","filterMembers","vnode","input","state","kids","judo","jujitsu","passive","active","resigned","extern","options","fuse","Fuse","members","keys","threshold","tokenize","filteredMembers","search","map","m","tags","filter","t","length","Grade","Dan","Kyu","undefined","mails","email","join","MembersList","oninit","q","request","method","url","then","result","view","onclick","e","preventDefault","window","location","href","oninput","target","placeholder","id","onchange","checked","entry","member","first_name","last_name","birthday","onload","mount","getElementById"],"mappings":"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","file":"list.js","sourceRoot":"../../frontend/src/members","sourcesContent":["function fallbackCopyTextToClipboard(text) {\n    var textArea = document.createElement(\"textarea\");\n    textArea.value = text;\n    document.body.appendChild(textArea);\n    textArea.focus();\n    textArea.select();\n\n    try {\n        var successful = document.execCommand('copy');\n        var msg = successful ? 'successful' : 'unsuccessful';\n        console.log('Fallback: Copying text command was ' + msg);\n    } catch (err) {\n        console.error('Fallback: Oops, unable to copy', err);\n    }\n\n    document.body.removeChild(textArea);\n}\n\nfunction copyTextToClipboard(text) {\n    if (!navigator.clipboard) {\n        fallbackCopyTextToClipboard(text);\n        return;\n    }\n    navigator.clipboard.writeText(text).catch(function(err) {\n        console.error('Async: Could not copy text: ', err);\n    });\n}\n\nconst filterMembers = function(vnode, input) {\n    let filters =\n        vnode.state.kids\n     && vnode.state.judo\n     && vnode.state.jujitsu\n     && vnode.state.passive\n     && vnode.state.active\n     && vnode.state.resigned\n     && vnode.state.extern\n\n    if(input && input != '') {\n        var options = {\n            keys: ['0.first_name', '0.last_name', '0.email_1'],\n            threshold: 0.00,\n            tokenize: true,\n        }\n        var fuse = new Fuse(vnode.state.members, options)\n        vnode.state.filteredMembers = fuse.search(input)\n    } else {\n        vnode.state.filteredMembers = vnode.state.members\n    }\n\n    vnode.state.filteredMembers = vnode.state.filteredMembers.map(m => {\n        let tags = m[3]\n        if(vnode.state.kids && tags.filter(t => t == 'Kid').length > 0) {\n            return m\n        }\n        if(\n            vnode.state.judo\n            && tags.filter(t => t.Grade && (\n                (t.Grade.Dan && t.Grade.Dan[0] == 'Judo')\n            || (t.Grade.Kyu && t.Grade.Kyu[0] == 'Judo')\n            )\n        ).length > 0) {\n            return m\n        }\n        if(\n            vnode.state.jujitsu\n            && tags.filter(t => t.Grade && (\n                (t.Grade.Dan && t.Grade.Dan[0] == 'JuJitsu')\n            || (t.Grade.Kyu && t.Grade.Kyu[0] == 'JuJitsu')\n            )\n        ).length > 0) {\n            return m\n        }\n        if(vnode.state.extern && tags.filter(t => t == 'Extern').length > 0) {\n            return m\n        }\n        return undefined\n    }).filter(m => m !== undefined)\n\n    vnode.state.filteredMembers = vnode.state.filteredMembers.map(m => {\n        let tags = m[3]\n        if(vnode.state.active && tags.filter(t => t == 'Active').length > 0) {\n            return m\n        }\n        if(vnode.state.passive && tags.filter(t => t == 'Passive').length > 0) {\n            return m\n        }\n        if(vnode.state.resigned && tags.filter(t => t == 'Resigned').length > 0) {\n            return m\n        }\n        if(vnode.state.extern && tags.filter(t => t == 'Extern').length > 0) {\n            return m\n        }\n        return undefined\n    }).filter(m => m !== undefined)\n\n    vnode.state.mails = vnode.state.filteredMembers.map(m => m[0].email).join(',')\n}\n\nvar MembersList = {\n    oninit: function(vnode) {\n        vnode.state.q = ''\n        vnode.state.kids = true\n        vnode.state.judo = true\n        vnode.state.jujitsu = true\n        vnode.state.passive = true\n        vnode.state.active = true\n        vnode.state.resigned = true\n        vnode.state.extern = true\n        vnode.state.mails = ''\n\n        m.request({\n            method: 'GET',\n            url: \"/members/list_json\",\n        })\n        .then(function(result) {\n            vnode.state.members = result;\n            filterMembers(vnode, vnode.state.q);\n        })\n    },\n    view: function(vnode) {\n        return [\n            m('div.col-9', m('form',\n                m('.form-group', [\n                    m('button.btn.btn-success[type=text]', {\n                        onclick: (e) => {\n                            e.preventDefault();\n                            window.location = '/members/view/0'\n                        }\n                    }, [m('i.fas.fa-plus'), ' Neues Mitglied hinzufügen.'])\n                ])\n            )),\n            m('div.col-3', m('p.text-right', [\n                m('a[href=#]', {\n                    onclick: e => {\n                        e.preventDefault()\n                        copyTextToClipboard(vnode.state.mails)\n                    }\n                }, 'Email-Liste kopieren ...'),\n                m('br'),\n                m('a', { href: 'mailto:' + vnode.state.mails }, 'Email an Liste schreiben ...'),\n            ])),\n            m('div.col-12', m('',\n                m('.form-group', [\n                    m('input[type=text].form-control[placeholder=\"Suche nach Vor- oder Nachname\"]', {\n                        value: vnode.state.q,\n                        oninput: function(e) {\n                            vnode.state.q = e.target.value;\n                            filterMembers(vnode, vnode.state.q);\n                        }\n                    })\n                ])\n            )),\n            m('div.col-12',\n                m('.row.form-group', [\n                    m('.col-2', m('label[for=field-kids]', 'Kinder')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.kids ? '[checked]' : ''), {\n                            placeholder: 'Kinder',\n                            id: 'field-kids',\n                            onchange: (e) => {\n                                vnode.state.kids = !vnode.state.kids\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-judo]', 'Judo')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.judo ? '[checked]' : ''), {\n                            placeholder: 'Judo',\n                            id: 'field-judo',\n                            onchange: (e) => {\n                                vnode.state.judo = !vnode.state.judo\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-jujitsu]', 'Ju Jitsu')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.jujitsu ? '[checked]' : ''), {\n                            placeholder: 'Ju Jitsu',\n                            id: 'field-jujitsu',\n                            onchange: (e) => {\n                                vnode.state.jujitsu = !vnode.state.jujitsu\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-resigned]', 'Extern')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input', {\n                            placeholder: 'Extern',\n                            id: 'field-external',\n                            checked: vnode.state.extern,\n                            onchange: (e) => {\n                                vnode.state.extern = !vnode.state.extern\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ])\n                ]),\n                m('.row.form-group', [\n                    m('.col-2', m('label[for=field-active]', 'Aktiv')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.active ? '[checked]' : ''), {\n                            placeholder: 'Aktiv',\n                            id: 'field-active',\n                            onchange: (e) => {\n                                vnode.state.active = !vnode.state.active\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-passive]', 'Passiv')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.passive ? '[checked]' : ''), {\n                            placeholder: 'Passiv',\n                            id: 'field-passive',\n                            onchange: (e) => {\n                                vnode.state.passive = !vnode.state.passive\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-resigned]', 'Ausgetreten')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.resigned ? '[checked]' : ''), {\n                            placeholder: 'Ausgetreten',\n                            id: 'field-resigned',\n                            onchange: (e) => {\n                                vnode.state.resigned = !vnode.state.resigned\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-resigned]', 'Extern')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input', {\n                            placeholder: 'Extern',\n                            id: 'field-external2',\n                            checked: vnode.state.extern,\n                            onchange: (e) => {\n                                vnode.state.extern = !vnode.state.extern\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ])\n                ])\n            ),\n            m('div.col-12', [\n                m('table.table.table-hover.col-12', [\n                    m('thead', m('tr', [\n                            m('th', 'ID'),\n                            m('th', 'Vorname'),\n                            m('th', 'Nachname(n)'),\n                            m('th', 'E-Mail'),\n                            m('th', 'Geburtstag'),\n                    ])),\n                    m('tbody', [\n                        vnode.state.filteredMembers ? vnode.state.filteredMembers.map(function(entry) {\n                            let member = entry[0];\n                            let events = entry[1];\n                            \n                            return [\n                                m('tr', {\n                                    onclick: function(e) {\n                                        e.preventDefault();\n                                        window.location = '/members/view/' + member.id;\n                                    },\n                                }, [\n                                    m('td', member.id),\n                                    m('td', member.first_name),\n                                    m('td', member.last_name),\n                                    m('td', member.email),\n                                    m('td', member.birthday),\n                                ]),\n                            ]\n                        }) : ''\n                    ])\n                ])\n            ])\n        ]\n    }\n}\n\nwindow.onload = function() {\n    m.mount(document.getElementById('mount'), MembersList)\n};"]}