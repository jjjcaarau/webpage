{"version":3,"sources":["list.js"],"names":["window","onload","filterMembers","vnode","input","options","keys","threshold","tokenize","fuse","Fuse","state","members","filteredMembers","search","q","MemberDetails","oninit","member","attrs","events","view","m","console","log","birthday","first_name","middle_name","last_name","postcode","city","address","address_no","email","phone_p","onclick","e","preventDefault","location","id","MembersList","selected","undefined","request","method","url","then","result","value","oninput","target","map","entry","mount","document","getElementById"],"mappings":"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","file":"list.js","sourceRoot":"../../frontend/src/members","sourcesContent":["window.onload = function() {\n    var filterMembers = function(vnode, input) {\n        if(input && input != '') {\n            var options = {\n                keys: ['0.first_name', '0.last_name', '0.email_1'],\n                threshold: 0.00,\n                tokenize: true,\n            };\n            var fuse = new Fuse(vnode.state.members, options);\n            vnode.state.filteredMembers = fuse.search(input);\n        } else {\n            vnode.state.filteredMembers = vnode.state.members;\n        }\n    }\n\n    var q = '';\n\n    var MemberDetails = {\n        oninit: function(vnode) {\n            vnode.state.member = vnode.attrs.member;\n            vnode.state.events = vnode.attrs.events;\n        },\n        view: function(vnode) {\n            let member = vnode.state.member;\n            let events = vnode.state.events;\n            return [\n                m('div.col-12', m('form#update-member',\n                    m('.form-row', [\n                        m('.col', [\n                            console.log(member.birthday),\n                            (member.birthday != '1970-01-01') ? m('label', member.first_name + ' ' + member.middle_name + ' ' + member.last_name + ', ' + member.birthday) : m('label', member.first_name + ' ' + member.middle_name + ' ' + member.last_name),\n                            //m('input[type=\"text\"][name=first_name].form-control[placeholder=\"First name\"]', { value: member.first_name })\n                        ]),\n                        /* m('.col', [\n                            m('label', member.middle_name),\n                            //m('input[type=\"text\"][name=middle_name].form-control[placeholder=\"Middle name\"]', { value: member.middle_name })\n                        ]),\n                        m('.col', [\n                            m('label', member.last_name),\n                            //m('input[type=\"text\"][name=last_name].form-control[placeholder=\"Last name\"]', { value: member.last_name })\n                        ]),\n                        m('.col', [\n                            m('label', member.birthday),\n                            //m('input[type=\"text\"][name=birthday].form-control[placeholder=\"Birthday\"]', { value: member.birthday })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        /* m('.col', [\n                            m('label', 'Sex'),\n                            m('input[type=\"text\"][name=sex].form-control[placeholder=\"Sex\"]', { value: member.sex })\n                        ]),\n                        m('.col', [\n                            m('label', member.birthday),\n                            //m('input[type=\"text\"][name=birthday].form-control[placeholder=\"Birthday\"]', { value: member.birthday })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        m('.col', [\n                            (member.postcode == '' && member.city == '' && member.address == '' && member.address_no == '') ? '' : m('label', member.postcode + ' ' + member.city + ', ' + member.address + ' ' + member.address_no),\n                            //m('input[type=\"text\"][name=address].form-control[placeholder=\"Address\"]', { value: member.address })\n                        ]),\n                        /* m('.col', [\n                            m('label', member.address_no),\n                            //m('input[type=\"text\"][name=address_no].form-control[placeholder=\"Address No\"]', { value: member.address_no })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        /*m('.col', [\n                            m('label', member.postcode + ' ' + member.city),\n                            //m('input[type=\"text\"][name=postcode].form-control[placeholder=\"PLZ\"]', { value: member.postcode })\n                        ]),\n                        m('.col', [\n                            m('label', member.city),\n                            //m('input[type=\"text\"][name=city].form-control[placeholder=\"City\"]', { value: member.city })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        m('.col', [\n                            (member.email != '' && member.phone_p != '') ? m('label', member.email + ' | ' + member.phone_p) : m('label', member.email + member.phone_p),\n                            \n                            //m('input[type=\"text\"][name=email].form-control[placeholder=\"Email\"]', { value: member.email })\n                        ]),\n                        /* m('.col', [\n                            m('label', member.phone_p),\n                            //m('input[type=\"text\"][name=phone_p].form-control[placeholder=\"Phone\"]', { value: member.phone_p })\n                        ]), */\n                    ]),\n                    /*m('.form-row', [\n                        m('.col', [\n                            m('label', 'Comment'),\n                            m('textarea[name=comment].form-control[placeholder=\"Comment\"]', { value: member.comment })\n                        ]),\n                    ]), */\n                    m('.form-row', [\n                        m('.col', [\n                            //m('button[type=\"submit\"].btn.btn-primary', {\n                            //    onclick: function(e) {\n                            //        e.preventDefault();\n                            //        updateMember(member);\n                            //    }\n                            //}, 'Save'),\n                            m('button[type=\"view\"].btn.btn-primary', {\n                                onclick: function(e) {\n                                    e.preventDefault();\n                                    window.location='/members/view/' + member.id;\n                                }\n                            }, 'Details'),\n                        ]),\n                    ]),\n                    m('.form-row', [\n                        m('.col', [\n                            m('.badge.badge-pill.badge-primary', ''),\n                        ]),\n                    ]),\n                    /* m('.form-row', [\n                        m('.col', [\n                            m(MemberEvents, { events: events })\n                        ]),\n                    ]), */\n                ))\n            ]\n        }\n    }\n\n    var MembersList = {\n        oninit: function(vnode) {\n            vnode.state.q = '';\n            vnode.state.selected = undefined;\n\n            m.request({\n                method: 'GET',\n                url: \"/members/list_json\",\n            })\n            .then(function(result) {\n                vnode.state.members = result;\n                filterMembers(vnode, vnode.state.q);\n            })\n        },\n        view: function(vnode) {\n            return [\n                m('div.col-12', m('form',\n                    m('.form-group', [\n                        m('input[type=text].form-control[placeholder=\"Suche nach Vor- oder Nachname\"]', {\n                            value: vnode.state.q,\n                            oninput: function(e) {\n                                vnode.state.q = e.target.value;\n                                filterMembers(vnode, vnode.state.q);\n                            }\n                        })\n                    ])\n                )),\n                m('div.col-12', [\n                    m('table.table.table-hover.col-12', [\n                        m('thead', m('tr', [\n                                m('th', 'ID'),\n                                m('th', 'Vorname'),\n                                m('th', 'Nachname(n)'),\n                                m('th', 'E-Mail'),\n                                m('th', 'Geburtstag'),\n                        ])),\n                        m('tbody', [\n                            [\n                                m('tr', {\n                                    onclick: function() {\n                                        vnode.state.selected = 0;\n                                    },\n                                }, //[\n                                //    m('td[colspan=4]', 'Add new member'),\n                                //]),\n                                ),\n                                vnode.state.selected == 0 ? m('tr', [\n                                    m('td[colspan=4]', m(MemberDetails, { member: { id: 0 }, events: [] })),\n                                ]) : '',\n                            ],\n                            vnode.state.filteredMembers ? vnode.state.filteredMembers.map(function(entry) {\n                                let member = entry[0];\n                                let events = entry[1];\n                                \n                                return [\n                                    m('tr', {\n                                        onclick: function() {\n                                            if (vnode.state.selected != member.id) {\n                                                vnode.state.selected = member.id;\n                                            } else {\n                                                vnode.state.selected = undefined;\n                                            }\n                                        },\n                                    }, [\n                                        m('td', member.id),\n                                        m('td', member.first_name),\n                                        m('td', member.last_name),\n                                        m('td', member.email),\n                                        m('td', member.birthday),\n                                    ]),\n                                    vnode.state.selected == member.id ? m('tr', [\n                                        m('td[colspan=4]', m(MemberDetails, { member: member, events: events })),\n                                    ]) : '',\n                                ]\n                            }) : ''\n                        ])\n                    ])\n                ])\n            ]\n        }\n    }\n\n    m.mount(document.getElementById('mount'), MembersList)\n};"]}