{"version":3,"sources":["list.js"],"names":["filterMembers","vnode","input","state","kids","judo","jujitsu","passive","active","resigned","extern","options","fuse","Fuse","members","keys","threshold","tokenize","filteredMembers","search","map","m","tags","filter","t","length","Grade","Dan","Kyu","undefined","MembersList","oninit","q","request","method","url","then","result","view","onclick","e","preventDefault","window","location","value","oninput","target","placeholder","id","onchange","checked","entry","member","first_name","last_name","email","birthday","onload","mount","document","getElementById"],"mappings":"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","file":"list.js","sourceRoot":"../../frontend/src/members","sourcesContent":["var filterMembers = function(vnode, input) {\n    let filters =\n        vnode.state.kids\n     && vnode.state.judo\n     && vnode.state.jujitsu\n     && vnode.state.passive\n     && vnode.state.active\n     && vnode.state.resigned\n     && vnode.state.extern\n\n    if(input && input != '') {\n        var options = {\n            keys: ['0.first_name', '0.last_name', '0.email_1'],\n            threshold: 0.00,\n            tokenize: true,\n        }\n        var fuse = new Fuse(vnode.state.members, options)\n        vnode.state.filteredMembers = fuse.search(input)\n    } else {\n        vnode.state.filteredMembers = vnode.state.members\n    }\n\n    vnode.state.filteredMembers = vnode.state.filteredMembers.map(m => {\n        let tags = m[3]\n        if(vnode.state.kids && tags.filter(t => t == 'Kid').length > 0) {\n            return m\n        }\n        if(\n            vnode.state.judo\n            && tags.filter(t => t.Grade && (\n                (t.Grade.Dan && t.Grade.Dan[0] == 'Judo')\n            || (t.Grade.Kyu && t.Grade.Kyu[0] == 'Judo')\n            )\n        ).length > 0) {\n            return m\n        }\n        if(\n            vnode.state.jujitsu\n            && tags.filter(t => t.Grade && (\n                (t.Grade.Dan && t.Grade.Dan[0] == 'JuJitsu')\n            || (t.Grade.Kyu && t.Grade.Kyu[0] == 'JuJitsu')\n            )\n        ).length > 0) {\n            return m\n        }\n        if(vnode.state.extern && tags.filter(t => t == 'Extern').length > 0) {\n            return m\n        }\n        return undefined\n    }).filter(m => m !== undefined)\n\n    vnode.state.filteredMembers = vnode.state.filteredMembers.map(m => {\n        let tags = m[3]\n        if(vnode.state.active && tags.filter(t => t == 'Active').length > 0) {\n            return m\n        }\n        if(vnode.state.passive && tags.filter(t => t == 'Passive').length > 0) {\n            return m\n        }\n        if(vnode.state.resigned && tags.filter(t => t == 'Resigned').length > 0) {\n            return m\n        }\n        if(vnode.state.extern && tags.filter(t => t == 'Extern').length > 0) {\n            return m\n        }\n        return undefined\n    }).filter(m => m !== undefined)\n}\n\nvar MembersList = {\n    oninit: function(vnode) {\n        vnode.state.q = ''\n        vnode.state.kids = true\n        vnode.state.judo = true\n        vnode.state.jujitsu = true\n        vnode.state.passive = true\n        vnode.state.active = true\n        vnode.state.resigned = true\n        vnode.state.extern = true\n\n        m.request({\n            method: 'GET',\n            url: \"/members/list_json\",\n        })\n        .then(function(result) {\n            vnode.state.members = result;\n            filterMembers(vnode, vnode.state.q);\n        })\n    },\n    view: function(vnode) {\n        return [\n            m('div.col-12', m('form',\n                m('.form-group', [\n                    m('button.btn.btn-success[type=text]', {\n                        onclick: (e) => {\n                            e.preventDefault();\n                            window.location = '/members/view/0'\n                        }\n                    }, [m('i.fas.fa-plus'), ' Neues Mitglied hinzufÃ¼gen.'])\n                ])\n            )),\n            m('div.col-12', m('',\n                m('.form-group', [\n                    m('input[type=text].form-control[placeholder=\"Suche nach Vor- oder Nachname\"]', {\n                        value: vnode.state.q,\n                        oninput: function(e) {\n                            vnode.state.q = e.target.value;\n                            filterMembers(vnode, vnode.state.q);\n                        }\n                    })\n                ])\n            )),\n            m('div.col-12',\n                m('.row.form-group', [\n                    m('.col-2', m('label[for=field-kids]', 'Kinder')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.kids ? '[checked]' : ''), {\n                            placeholder: 'Kinder',\n                            id: 'field-kids',\n                            onchange: (e) => {\n                                vnode.state.kids = !vnode.state.kids\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-judo]', 'Judo')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.judo ? '[checked]' : ''), {\n                            placeholder: 'Judo',\n                            id: 'field-judo',\n                            onchange: (e) => {\n                                vnode.state.judo = !vnode.state.judo\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-jujitsu]', 'Ju Jitsu')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.jujitsu ? '[checked]' : ''), {\n                            placeholder: 'Ju Jitsu',\n                            id: 'field-jujitsu',\n                            onchange: (e) => {\n                                vnode.state.jujitsu = !vnode.state.jujitsu\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-resigned]', 'Extern')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input', {\n                            placeholder: 'Extern',\n                            id: 'field-external',\n                            checked: vnode.state.extern,\n                            onchange: (e) => {\n                                vnode.state.extern = !vnode.state.extern\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ])\n                ]),\n                m('.row.form-group', [\n                    m('.col-2', m('label[for=field-active]', 'Aktiv')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.active ? '[checked]' : ''), {\n                            placeholder: 'Aktiv',\n                            id: 'field-active',\n                            onchange: (e) => {\n                                vnode.state.active = !vnode.state.active\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-passive]', 'Passiv')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.passive ? '[checked]' : ''), {\n                            placeholder: 'Passiv',\n                            id: 'field-passive',\n                            onchange: (e) => {\n                                vnode.state.passive = !vnode.state.passive\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-resigned]', 'Ausgetreten')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input' + (vnode.state.resigned ? '[checked]' : ''), {\n                            placeholder: 'Ausgetreten',\n                            id: 'field-resigned',\n                            onchange: (e) => {\n                                vnode.state.resigned = !vnode.state.resigned\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ]),\n                    m('.col-2', m('label[for=field-resigned]', 'Extern')),\n                    m('.form-check.col-1', [\n                        m('input[type=checkbox].form-check-input', {\n                            placeholder: 'Extern',\n                            id: 'field-external2',\n                            checked: vnode.state.extern,\n                            onchange: (e) => {\n                                vnode.state.extern = !vnode.state.extern\n                                filterMembers(vnode, vnode.state.q)\n                            },\n                        }),\n                    ])\n                ])\n            ),\n            m('div.col-12', [\n                m('table.table.table-hover.col-12', [\n                    m('thead', m('tr', [\n                            m('th', 'ID'),\n                            m('th', 'Vorname'),\n                            m('th', 'Nachname(n)'),\n                            m('th', 'E-Mail'),\n                            m('th', 'Geburtstag'),\n                    ])),\n                    m('tbody', [\n                        vnode.state.filteredMembers ? vnode.state.filteredMembers.map(function(entry) {\n                            let member = entry[0];\n                            let events = entry[1];\n                            \n                            return [\n                                m('tr', {\n                                    onclick: function(e) {\n                                        e.preventDefault();\n                                        window.location = '/members/view/' + member.id;\n                                    },\n                                }, [\n                                    m('td', member.id),\n                                    m('td', member.first_name),\n                                    m('td', member.last_name),\n                                    m('td', member.email),\n                                    m('td', member.birthday),\n                                ]),\n                            ]\n                        }) : ''\n                    ])\n                ])\n            ])\n        ]\n    }\n}\n\nwindow.onload = function() {\n    m.mount(document.getElementById('mount'), MembersList)\n};"]}