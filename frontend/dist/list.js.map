{"version":3,"sources":["list.js"],"names":["window","onload","filterMembers","vnode","input","options","keys","threshold","tokenize","fuse","Fuse","state","members","filteredMembers","search","updateMember","member","formData","FormData","document","getElementById","data","entries","entry","id","email_2","email_3","phone_g","mobile","m","request","method","url","then","result","console","log","q","MemberDetails","oninit","attrs","events","view","birthday","first_name","middle_name","last_name","postcode","city","address","address_no","email","phone_p","onclick","e","preventDefault","location","MemberEvents","badges","already_left","current_grade","forEach","event","event_type","division","class","push","type","text","date","includes","grade","substring","length","map","badge","slice","reverse","comment","MembersList","selected","undefined","value","oninput","target","mount"],"mappings":"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","file":"list.js","sourceRoot":"../src/members","sourcesContent":["window.onload = function() {\n    var filterMembers = function(vnode, input) {\n        if(input && input != '') {\n            var options = {\n                keys: ['0.first_name', '0.last_name', '0.email_1'],\n                threshold: 0.00,\n                tokenize: true,\n            };\n            var fuse = new Fuse(vnode.state.members, options);\n            vnode.state.filteredMembers = fuse.search(input);\n        } else {\n            vnode.state.filteredMembers = vnode.state.members;\n        }\n    }\n\n    var updateMember = function(member) {\n        var formData = new FormData(document.getElementById('update-member'));\n        var data = {};\n        for(var entry of formData.entries()) {\n            data[entry[0]] = entry[1];\n        }\n        data['id'] = member.id;\n        data['email_2'] = member.email_2 ? member.email_2: '';\n        data['email_3'] = member.email_3 ? member.email_3: '';\n        data['phone_g'] = member.phone_g ? member.phone_g: '';\n        data['mobile'] = member.mobile ? member.mobile : '';\n\n        m.request({\n            method: 'POST',\n            url: '/members/update',\n            data: data,\n        })\n        .then(function(result) {\n            console.log('success');\n        })\n    }\n\n    var q = '';\n\n    var MemberDetails = {\n        oninit: function(vnode) {\n            vnode.state.member = vnode.attrs.member;\n            vnode.state.events = vnode.attrs.events;\n        },\n        view: function(vnode) {\n            let member = vnode.state.member;\n            let events = vnode.state.events;\n            return [\n                m('div.col-12', m('form#update-member',\n                    m('.form-row', [\n                        m('.col', [\n                            console.log(member.birthday),\n                            (member.birthday != '1970-01-01') ? m('label', member.first_name + ' ' + member.middle_name + ' ' + member.last_name + ', ' + member.birthday) : m('label', member.first_name + ' ' + member.middle_name + ' ' + member.last_name),\n                            //m('input[type=\"text\"][name=first_name].form-control[placeholder=\"First name\"]', { value: member.first_name })\n                        ]),\n                        /* m('.col', [\n                            m('label', member.middle_name),\n                            //m('input[type=\"text\"][name=middle_name].form-control[placeholder=\"Middle name\"]', { value: member.middle_name })\n                        ]),\n                        m('.col', [\n                            m('label', member.last_name),\n                            //m('input[type=\"text\"][name=last_name].form-control[placeholder=\"Last name\"]', { value: member.last_name })\n                        ]),\n                        m('.col', [\n                            m('label', member.birthday),\n                            //m('input[type=\"text\"][name=birthday].form-control[placeholder=\"Birthday\"]', { value: member.birthday })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        /* m('.col', [\n                            m('label', 'Sex'),\n                            m('input[type=\"text\"][name=sex].form-control[placeholder=\"Sex\"]', { value: member.sex })\n                        ]),\n                        m('.col', [\n                            m('label', member.birthday),\n                            //m('input[type=\"text\"][name=birthday].form-control[placeholder=\"Birthday\"]', { value: member.birthday })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        m('.col', [\n                            (member.postcode == '' && member.city == '' && member.address == '' && member.address_no == '') ? '' : m('label', member.postcode + ' ' + member.city + ', ' + member.address + ' ' + member.address_no),\n                            //m('input[type=\"text\"][name=address].form-control[placeholder=\"Address\"]', { value: member.address })\n                        ]),\n                        /* m('.col', [\n                            m('label', member.address_no),\n                            //m('input[type=\"text\"][name=address_no].form-control[placeholder=\"Address No\"]', { value: member.address_no })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        /*m('.col', [\n                            m('label', member.postcode + ' ' + member.city),\n                            //m('input[type=\"text\"][name=postcode].form-control[placeholder=\"PLZ\"]', { value: member.postcode })\n                        ]),\n                        m('.col', [\n                            m('label', member.city),\n                            //m('input[type=\"text\"][name=city].form-control[placeholder=\"City\"]', { value: member.city })\n                        ]), */\n                    ]),\n                    m('.form-row', [\n                        m('.col', [\n                            (member.email != '' && member.phone_p != '') ? m('label', member.email + ' | ' + member.phone_p) : m('label', member.email + member.phone_p),\n                            \n                            //m('input[type=\"text\"][name=email].form-control[placeholder=\"Email\"]', { value: member.email })\n                        ]),\n                        /* m('.col', [\n                            m('label', member.phone_p),\n                            //m('input[type=\"text\"][name=phone_p].form-control[placeholder=\"Phone\"]', { value: member.phone_p })\n                        ]), */\n                    ]),\n                    /*m('.form-row', [\n                        m('.col', [\n                            m('label', 'Comment'),\n                            m('textarea[name=comment].form-control[placeholder=\"Comment\"]', { value: member.comment })\n                        ]),\n                    ]), */\n                    m('.form-row', [\n                        m('.col', [\n                            //m('button[type=\"submit\"].btn.btn-primary', {\n                            //    onclick: function(e) {\n                            //        e.preventDefault();\n                            //        updateMember(member);\n                            //    }\n                            //}, 'Save'),\n                            m('button[type=\"view\"].btn.btn-primary', {\n                                onclick: function(e) {\n                                    e.preventDefault();\n                                    window.location='/members/view/' + member.id;\n                                }\n                            }, 'Details'),\n                        ]),\n                    ]),\n                    m('.form-row', [\n                        m('.col', [\n                            m('.badge.badge-pill.badge-primary', ''),\n                        ]),\n                    ]),\n                    /* m('.form-row', [\n                        m('.col', [\n                            m(MemberEvents, { events: events })\n                        ]),\n                    ]), */\n                ))\n            ]\n        }\n    }\n\n    var MemberEvents = {\n        oninit: function(vnode) {\n            vnode.state.events = vnode.attrs.events;\n        },\n        view: function(vnode) {\n            let member = vnode.state.member;\n            let events = vnode.state.events;\n\n            let badges = []\n\n            let already_left = false\n            let current_grade = []\n            current_grade['Judo'] = false\n            current_grade['Jujitsu'] = false\n\n            events.forEach(function(event) {\n                if (event.event_type == 'Club' && event.division == 'Club' && event.class == 'Demotion') {\n                    badges.push({ type: 'danger', text: 'Left on ' + event.date })\n                    already_left = true\n                }\n\n                if (!already_left && event.event_type == 'Club' && event.division == 'Club' && event.class == 'Promotion') {\n                    badges.push({ type: 'success', text: 'Joined on ' + event.date })\n                }\n\n                if ((event.event_type.includes('Kyu') || event.event_type.includes('Dan')) && event.class == 'Promotion') {\n                    let grade = event.event_type.substring(event.event_type.length - 1)\n                              + '. '\n                              + event.event_type.substring(0, event.event_type.length - 1);\n\n                    current_grade[event.division] = { grade, date: event.date };\n                }\n            });\n\n            if(current_grade['Judo']) {\n                badges.push({ type: 'success', text: 'Promoted to ' + current_grade['Judo'].grade + ' on ' + current_grade['Judo'].date })\n            }\n            if(current_grade['Jujitsu']) {\n                badges.push({ type: 'success', text: 'Promoted to ' + current_grade['Jujitsu'].grade + ' on ' + current_grade['Jujitsu'].date })\n            }\n\n            return [\n                m('', badges.map(function(badge) {\n                    return m('span.badge.badge-pill.badge-' + badge.type , badge.text)\n                })),\n                m('table.table.table-hover.col-12', [\n                    m('thead', m('tr', [\n                            m('th', 'Event'),\n                            m('th', 'Division'),\n                            m('th', 'Class'),\n                            m('th', 'Date'),\n                            m('th', 'Comment'),\n                    ])),\n                    m('tbody', [\n                        [\n                            m('tr', [\n                                m('td[colspan=4]', 'Add new event'),\n                            ]),\n                        ],\n                        events.slice(0).reverse().map(function(event) {\n                            return [\n                                m('tr', [\n                                    m('td', event.event_type),\n                                    m('td', event.division),\n                                    m('td', event.class),\n                                    m('td', event.date),\n                                    m('td', event.comment),\n                                ]),\n                            ]\n                        })\n                    ])\n                ])\n            ]\n        }\n    }\n\n    var MembersList = {\n        oninit: function(vnode) {\n            vnode.state.q = '';\n            vnode.state.selected = undefined;\n\n            m.request({\n                method: 'GET',\n                url: \"/members/list_json\",\n            })\n            .then(function(result) {\n                vnode.state.members = result;\n                filterMembers(vnode, vnode.state.q);\n            })\n        },\n        view: function(vnode) {\n            return [\n                m('div.col-12', m('form',\n                    m('.form-group', [\n                        m('input[type=text].form-control[placeholder=\"Suche nach Vor- oder Nachname\"]', {\n                            value: vnode.state.q,\n                            oninput: function(e) {\n                                vnode.state.q = e.target.value;\n                                filterMembers(vnode, vnode.state.q);\n                            }\n                        })\n                    ])\n                )),\n                m('div.col-12', [\n                    m('table.table.table-hover.col-12', [\n                        m('thead', m('tr', [\n                                m('th', 'ID'),\n                                m('th', 'Vorname'),\n                                m('th', 'Nachname(n)'),\n                                m('th', 'E-Mail'),\n                                m('th', 'Geburtstag'),\n                        ])),\n                        m('tbody', [\n                            [\n                                m('tr', {\n                                    onclick: function() {\n                                        vnode.state.selected = 0;\n                                    },\n                                }, //[\n                                //    m('td[colspan=4]', 'Add new member'),\n                                //]),\n                                ),\n                                vnode.state.selected == 0 ? m('tr', [\n                                    m('td[colspan=4]', m(MemberDetails, { member: { id: 0 }, events: [] })),\n                                ]) : '',\n                            ],\n                            vnode.state.filteredMembers ? vnode.state.filteredMembers.map(function(entry) {\n                                let member = entry[0];\n                                let events = entry[1];\n                                \n                                return [\n                                    m('tr', {\n                                        onclick: function() {\n                                            if (vnode.state.selected != member.id) {\n                                                vnode.state.selected = member.id;\n                                            } else {\n                                                vnode.state.selected = undefined;\n                                            }\n                                        },\n                                    }, [\n                                        m('td', member.id),\n                                        m('td', member.first_name),\n                                        m('td', member.last_name),\n                                        m('td', member.email),\n                                        m('td', member.birthday),\n                                    ]),\n                                    vnode.state.selected == member.id ? m('tr', [\n                                        m('td[colspan=4]', m(MemberDetails, { member: member, events: events })),\n                                    ]) : '',\n                                ]\n                            }) : ''\n                        ])\n                    ])\n                ])\n            ]\n        }\n    }\n\n    m.mount(document.getElementById('mount'), MembersList)\n};"]}